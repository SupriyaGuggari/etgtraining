Assignment-1

SELECT DEPTNO ,SUM(SAL) AS 'TOTAL_SAL'
FROM EMP
GROUP BY DEPTNO;

SELECT ENAME , EMPNO,DEPTNO, SAL
FROM EMP
WHERE SAL IN (SELECT MIN(SAL) AS 'MIN_SAL' FROM EMP GROUP BY DEPTNO HAVING DEPTNO = 10);

SELECT JOB ,AVG(SAL) AS ' AVG_SAL'
FROM EMP
GROUP BY JOB
HAVING JOB = 'MANAGER';

SELECT JOB ,SUM(sal) as 'total_sal'
FROM EMP
GROUP BY JOB
HAVING JOB='SALESMAN';

SELECT TOP 1 DEPTNO , AVG(SAL) AVERAGE
FROM EMP
GROUP BY DEPTNO
ORDER BY AVERAGE;

SELECT JOB ,COUNT(JOB) AS ' ROLE'
FROM EMP
GROUP BY JOB;

SELECT JOB ,MAX(SAL) AS 'HIGH_SAL'
FROM EMP
GROUP BY JOB
HAVING JOB = 'ANALYST';

SELECT MAX(ISNULL(COMM,0)) AS 'HIGH_COMM'
FROM EMP

SELECT COUNT(DISTINCT DEPTNO) AS 'TOTAL_DEPT'
FROM EMP;


Assignment -2

SELECT e.EMPNO ,e.ENAME ,d.LOC
FROM EMP e,DEPT d
WHERE d.DEPTNO = e.DEPTNO AND d.LOC = 'CHICAGO' ;

SELECT e.ENAME , d.LOC
FROM EMP e,DEPT d
WHERE d.DEPTNO =E.DEPTNO
ORDER BY d.LOC;

SELECT e.ENAME , e.HIREDATE,m.ENAME,m.HIREDATE
FROM EMP e,EMP m
WHERE e.EMPNO = m.MGR AND e.HIREDATE < m.HIREDATE;


SELECT e.ENAME , d.DNAME
FROM EMP e,DEPT d
WHERE d.DEPTNO =E.DEPTNO;

SELECT e.ENAME , d.LOC
FROM EMP e,DEPT d
WHERE d.DEPTNO =E.DEPTNO;

SELECT e.ENAME, e.HIREDATE ,j.startdate ,j.enddate
FROM EMP e, JOBHIST j
WHERE e.HIREDATE BETWEEN j.startdate AND j.enddate;

Assignment -3
SELECT e.EMPNO ,e.ENAME ,d.LOC
FROM EMP e  FULL OUTER JOIN  DEPT d
ON ( d.DEPTNO = e.DEPTNO )
WHERE  d.LOC = 'CHICAGO' ;

SELECT e.ENAME , d.LOC
FROM EMP e LEFT OUTER JOIN DEPT d
 ON(d.DEPTNO =E.DEPTNO)
ORDER BY d.LOC;

SELECT Manger.ENAME AS 'MANAGER', employee.ENAME AS 'EMPLOYEE'
FROM  EMP Manger FULL OUTER JOIN EMP employee
ON (Manger.EMPNO = employee.MGR)
where Manger.HIREDATE < employee.HIREDATE;

SELECT e.ENAME , d.DNAME
FROM EMP e JOIN DEPT d
ON( d.DEPTNO =E.DEPTNO);

SELECT e.ENAME , d.LOC
FROM EMP e JOIN DEPT d
ON( d.DEPTNO =E.DEPTNO);

SELECT e.ENAME, e.HIREDATE ,j.startdate ,j.enddate
FROM EMP e JOIN JOBHIST j
ON( e.HIREDATE BETWEEN j.startdate AND j.enddate);

Assignment-4

SELECT ENAME,JOB
FROM EMP
WHERE JOB ='MANAGER';

SELECT ENAME,
  ( CASE WHEN JOB = 'SALESMAN'
  THEN 'SALES' ELSE 'NOT_SALES' END) JOB
  FROM EMP;

SELECT ENAME,
  (CASE WHEN SAL > 1000 
    THEN SAL ELSE '1000' END) SAL
FROM EMP;

SELECT ENAME,
  (CASE WHEN SAL < 1000 THEN 'LOW'
       WHEN SAL BETWEEN 1000 AND 2500  THEN 'MEDIUM'
	   ELSE 'HIGH' END) SAL
FROM EMP;

SELECT ENAME,JOB,SAL
FROM EMP e
WHERE SAL > (SELECT SAL FROM EMP WHERE ENAME='MILLER')
AND JOB='SALESMAN' ;

SELECT *
FROM EMP 
WHERE DEPTNO =( SELECT DEPTNO FROM DEPT WHERE LOC='CHICAGO');

SELECT ENAME ,SAL,JOB
FROM EMP
WHERE SAL > ( SELECT MIN(SAL) FROM EMP WHERE JOB='MANAGER');

SELECT ENAME ,JOB
FROM EMP
WHERE DEPTNO = (SELECT DEPTNO FROM DEPT WHERE DNAME='ACCOUNTING');

SELECT COUNT(DEPTNO) AS 'COUNT'
FROM EMP 
WHERE DEPTNO =( SELECT DEPTNO FROM DEPT WHERE LOC='CHICAGO');

SELECT ENAME
FROM EMP
WHERE DEPTNO = (SELECT DEPTNO FROM DEPT WHERE LOC= 'CHICAGO');

SELECT DEPTNO,DNAME
FROM DEPT
WHERE DEPTNO NOT IN (SELECT DEPTNO FROM EMP);

SELECT ENAME ,JOB
FROM EMP
WHERE EMPNO NOT IN (SELECT EMPNO FROM EMP WHERE MGR IS NOT NULL);

SELECT ENAME,JOB 
FROM EMP 
WHERE DEPTNO = (SELECT DEPTNO FROM DEPT WHERE LOC= 'NEW YORK')
AND COMM > 1000;
