ASSIGNEMT -1

CREATE TABLE OWNER_DETAILS
(OWNER_ID INT NOT NULL,
 OWNER_NAME VARCHAR(30));

CREATE TABLE PET_TYPE_DETAILS
(PET_TYPE_ID INT NOT NULL,
PET_TYPE VARCHAR(20));

CREATE TABLE PROCEDURE_DETAILS
(PROCEDURE_ID INT NOT NULL,
PROCEDURE_DETAILS VARCHAR(30));

CREATE TABLE PET_DETAILS
(PET_ID INT NOT NULL,
 PET_NAME VARCHAR(20),
 PET_TYPE_ID INT,
 PET_AGE INT,
 OWNER_ID INT);

CREATE TABLE VISIT_DETAILS
(PET_ID INT,
VISIT_DATE DATE NOT NULL,
PROCEDURE_ID INT);

ASSIGNMENT-2

INSERT INTO OWNER_DETAILS (OWNER_ID,OWNER_NAME) VALUES (1,'SAM COOK');
INSERT INTO OWNER_DETAILS (OWNER_ID,OWNER_NAME) VALUES (2,'TERRY KIM');

INSERT INTO PET_TYPE_DETAILS(PET_TYPE_ID,PET_TYPE) VALUES (101,'DOG');
INSERT INTO PET_TYPE_DETAILS(PET_TYPE_ID,PET_TYPE) VALUES (102,'CAT');
INSERT INTO PET_TYPE_DETAILS(PET_TYPE_ID,PET_TYPE) VALUES (103,'BIRD');

INSERT INTO PROCEDURE_DETAILS(PROCEDURE_ID,PROCEDURE_DETAILS) VALUES (01,'RABIES VACCINATION');
INSERT INTO PROCEDURE_DETAILS(PROCEDURE_ID,PROCEDURE_DETAILS) VALUES (05,'HEART WORM TEST');
INSERT INTO PROCEDURE_DETAILS(PROCEDURE_ID,PROCEDURE_DETAILS) VALUES (08,'TETANUS VACCINATION');
INSERT INTO PROCEDURE_DETAILS(PROCEDURE_ID,PROCEDURE_DETAILS) VALUES (10,'EXAMINE & TREAT WOUND');
INSERT INTO PROCEDURE_DETAILS(PROCEDURE_ID,PROCEDURE_DETAILS) VALUES (12,'EYE WASH');
INSERT INTO PROCEDURE_DETAILS(PROCEDURE_ID,PROCEDURE_DETAILS) VALUES (20,'ANNUAL CHECKUP');

INSERT INTO PET_DETAILS(PET_ID,PET_NAME,PET_TYPE_ID,PET_AGE,OWNER_ID) VALUES (201,'ROVER',101,12,1);
INSERT INTO PET_DETAILS(PET_ID,PET_NAME,PET_TYPE_ID,PET_AGE,OWNER_ID) VALUES (202,'SPOT',101,2,2);
INSERT INTO PET_DETAILS(PET_ID,PET_NAME,PET_TYPE_ID,PET_AGE,OWNER_ID) VALUES (203,'MORRIS',102,4,1);
INSERT INTO PET_DETAILS(PET_ID,PET_NAME,PET_TYPE_ID,PET_AGE,OWNER_ID) VALUES (204,'TWEEDY',103,2,2);

INSERT INTO VISIT_DETAILS(PET_ID,VISIT_DATE,PROCEDURE_ID) VALUES (201,'13-JAN-2002',01);
INSERT INTO VISIT_DETAILS(PET_ID,VISIT_DATE,PROCEDURE_ID) VALUES (201,'27-MAR-2002',10);
INSERT INTO VISIT_DETAILS(PET_ID,VISIT_DATE,PROCEDURE_ID) VALUES (201,'02-APR-2002',05);
INSERT INTO VISIT_DETAILS(PET_ID,VISIT_DATE,PROCEDURE_ID) VALUES (202,'21-JAN-2002',08);
INSERT INTO VISIT_DETAILS(PET_ID,VISIT_DATE,PROCEDURE_ID) VALUES (201,'10-MAR-2002',05);
INSERT INTO VISIT_DETAILS(PET_ID,VISIT_DATE,PROCEDURE_ID) VALUES (203,'23-JAN-2001',01);
INSERT INTO VISIT_DETAILS(PET_ID,VISIT_DATE,PROCEDURE_ID) VALUES (201,'13-JAN-2002',01);
INSERT INTO VISIT_DETAILS(PET_ID,VISIT_DATE,PROCEDURE_ID) VALUES (204,'30-APR-2002',20);
INSERT INTO VISIT_DETAILS(PET_ID,VISIT_DATE,PROCEDURE_ID) VALUES (204,'30-APR-2002',12);

SELECT * FROM OWNER_DETAILS;

SELECT * FROM PET_TYPE_DETAILS;

SELECT * FROM PROCEDURE_DETAILS;

SELECT * FROM PET_DETAILS;

SELECT * FROM VISIT_DETAILS;

ASSINMENT-3

ALTER TABLE OWNER_DETAILS
ADD CONSTRAINT OWN_ID_PK PRIMARY KEY (OWNER_ID);

ALTER TABLE PET_TYPE_DETAILS
ADD CONSTRAINT PETP_ID_PK PRIMARY KEY (PET_TYPE_ID);

ALTER TABLE PROCEDURE_DETAILS
ADD CONSTRAINT PRO_ID_PK PRIMARY KEY (PROCEDURE_ID);

ALTER TABLE PET_DETAILS
ADD CONSTRAINT PET_ID_PK PRIMARY KEY (PET_ID);

ALTER TABLE PET_DETAILS
ADD CONSTRAINT PETP_ID_FK FOREIGN KEY (PET_TYPE_ID) REFERENCES PET_TYPE_DETAILS(PET_TYPE_ID);

ALTER TABLE PET_DETAILS
ADD CONSTRAINT OWN_ID_FK FOREIGN KEY (OWNER_ID) REFERENCES OWNER_DETAILS(OWNER_ID);

ALTER TABLE VISIT_DETAILS
ADD CONSTRAINT PET_ID_FK FOREIGN KEY (PET_ID) REFERENCES PET_DETAILS(PET_ID);

ALTER TABLE VISIT_DETAILS
ADD CONSTRAINT PRO_ID_FK FOREIGN KEY (PROCEDURE_ID) REFERENCES PROCEDURE_DETAILS(PROCEDURE_ID);

ASSIGNMENT -4

SELECT EMP.EMPNO ,ename,jobhist.startdate,jobhist.enddate,jobhist.chgdesc
FROM EMP,jobhist
intersect
SELECT jobhist.EMPNO,emp.ename, jobhist.startdate,jobhist.enddate,jobhist.chgdesc
FROM JOBHIST,emp
WHERE ENDDATE IS NOT NULL and emp.empno=jobhist.empno
ORDER BY startdate;


SELECT EMPNO,COMM,DEPTNO,HIREDATE
FROM emp 
UNION ALL
SELECT empno ,COMM,DEPTNO,enddate
FROM jobhist
ORDER BY HIREDATE DESC;

SELECT EMPNO
FROM EMP
WHERE COMM IS NOT NULL AND COMM != 0
INTERSECT
SELECT EMPNO
FROM jobhist
WHERE COMM IS NOT NULL and enddate is not null;

SELECT EMPNO
FROM EMP
WHERE JOB = 'SALESMAN'
EXCEPT
SELECT EMPNO
FROM jobhist
WHERE JOB ='SALESMAN' AND enddate IS NOT NULL;


select e.ename,e.empno,d.deptno,d.dname
from dept d 
full outer join 
emp e 
on(d.deptno=e.deptno)
where d.deptno in (select d.deptno FROM dept d UNION SELECT e.deptno FROM emp e)


CREATE VIEW EMP10
AS SELECT  EMPNO, ENAME, SAL
    FROM    EMP
    WHERE   DEPTNO = 10;

SELECT * FROM EMP10;

CREATE VIEW	dept_sum_vu
  ( dname,minsal, maxsal, avgsal)
AS SELECT	 d.DNAME ,MIN(e.SAL), 
             MAX(e.SAL),AVG(e.SAL)
   FROM      EMP e, DEPT d
   WHERE     e.DEPTNO = d.DEPTNO 
   GROUP BY  d.DNAME;

   SELECT * FROM  dept_sum_vu;
   SELECT dname,minsal from dept_sum_vu;
